{
  "summary": {
    "total_files": 9,
    "total_issues": 15,
    "env_vars_found": 55,
    "secrets_found": 24,
    "error_count": 0,
    "warning_count": 15
  },
  "env_vars": [
    "API_BASE_URL",
    "AUTHOR",
    "BRANCH",
    "CC_TEST_REPORTER_ID",
    "CI",
    "CODECOV_TOKEN",
    "COMMIT_SHA",
    "COVERAGE_THRESHOLD",
    "DATABASE_URL",
    "DEPLOYMENT_READY",
    "DEPLOY_URL",
    "EMAIL_FROM",
    "EMAIL_PASSWORD",
    "EMAIL_SMTP_HOST",
    "EMAIL_SMTP_PORT",
    "EMAIL_TO",
    "EMAIL_USERNAME",
    "ENVIRONMENT",
    "FRONTEND_BASE_URL",
    "GITHUB_TOKEN",
    "IMAGE_PREFIX",
    "JAVA_VERSION",
    "JWT_SECRET",
    "NODE_ENV",
    "NODE_VERSION",
    "NOTIFICATION_TYPE",
    "OIDC_BASE_URL",
    "PERFORMANCE_BUDGET_ERROR_RATE",
    "PERFORMANCE_BUDGET_RESPONSE_TIME",
    "PERFORMANCE_BUDGET_THROUGHPUT",
    "PLAYWRIGHT_HTML_REPORT",
    "PNPM_VERSION",
    "POSTGRES_DB",
    "POSTGRES_PASSWORD",
    "PR_NUMBER",
    "PYTHONPATH",
    "PYTHON_VERSION",
    "REDIS_URL",
    "REGISTRY",
    "SENDGRID_API_KEY",
    "SENTRY_DSN",
    "SLACK_WEBHOOK_URL",
    "SONARQUBE_TOKEN",
    "SONARQUBE_URL",
    "SONAR_HOST_URL",
    "SONAR_TOKEN",
    "STRIPE_SECRET_KEY",
    "TEAMS_WEBHOOK_URL",
    "TEST_TIMEOUT",
    "UPTIME_ROBOT_API_KEY",
    "WORKFLOW_DATA",
    "WORKFLOW_NAME",
    "WORKFLOW_STATUS",
    "discovery.type",
    "xpack.security.enabled"
  ],
  "secrets": [
    "CC_TEST_REPORTER_ID",
    "CODECOV_TOKEN",
    "DATABASE_URL",
    "EMAIL_FROM",
    "EMAIL_PASSWORD",
    "EMAIL_SMTP_HOST",
    "EMAIL_SMTP_PORT",
    "EMAIL_TO",
    "EMAIL_USERNAME",
    "GITHUB_TOKEN",
    "JWT_SECRET",
    "KUBE_CONFIG_PRODUCTION",
    "KUBE_CONFIG_STAGING",
    "REDIS_URL",
    "SENDGRID_API_KEY",
    "SENTRY_DSN",
    "SLACK_WEBHOOK_URL",
    "SONARQUBE_TOKEN",
    "SONARQUBE_URL",
    "SONAR_HOST_URL",
    "SONAR_TOKEN",
    "STRIPE_SECRET_KEY",
    "TEAMS_WEBHOOK_URL",
    "UPTIME_ROBOT_API_KEY"
  ],
  "issues": [
    {
      "file": ".github/workflows/ci.yml",
      "type": "missing_env_var",
      "message": "缺少必需的环境变量: NODE_VERSION",
      "severity": "warning",
      "recommendation": "添加环境变量 NODE_VERSION 到工作流配置中"
    },
    {
      "file": ".github/workflows/deploy.yml",
      "type": "missing_env_var",
      "message": "缺少必需的环境变量: DEPLOY_HOST",
      "severity": "warning",
      "recommendation": "添加环境变量 DEPLOY_HOST 到工作流配置中"
    },
    {
      "file": ".github/workflows/deploy.yml",
      "type": "missing_env_var",
      "message": "缺少必需的环境变量: DEPLOY_USER",
      "severity": "warning",
      "recommendation": "添加环境变量 DEPLOY_USER 到工作流配置中"
    },
    {
      "file": ".github/workflows/docker-build.yml",
      "type": "missing_permissions",
      "message": "使用GITHUB_TOKEN但未定义permissions",
      "severity": "warning",
      "recommendation": "添加适当的permissions配置以遵循最小权限原则"
    },
    {
      "file": ".github/workflows/notifications.yml",
      "type": "insecure_env",
      "path": "jobs.send-slack-notification.steps[0].env.AUTHOR",
      "message": "敏感环境变量应使用secrets: AUTHOR",
      "severity": "warning",
      "recommendation": "使用 ${{ secrets.AUTHOR }} 替代直接赋值"
    },
    {
      "file": ".github/workflows/notifications.yml",
      "type": "insecure_env",
      "path": "jobs.send-email-notification.steps[0].env.AUTHOR",
      "message": "敏感环境变量应使用secrets: AUTHOR",
      "severity": "warning",
      "recommendation": "使用 ${{ secrets.AUTHOR }} 替代直接赋值"
    },
    {
      "file": ".github/workflows/notifications.yml",
      "type": "missing_permissions",
      "message": "使用GITHUB_TOKEN但未定义permissions",
      "severity": "warning",
      "recommendation": "添加适当的permissions配置以遵循最小权限原则"
    },
    {
      "file": ".github/workflows/performance-monitoring.yml",
      "type": "missing_permissions",
      "message": "使用GITHUB_TOKEN但未定义permissions",
      "severity": "warning",
      "recommendation": "添加适当的permissions配置以遵循最小权限原则"
    },
    {
      "file": ".github/workflows/test-report.yml",
      "type": "missing_permissions",
      "message": "使用GITHUB_TOKEN但未定义permissions",
      "severity": "warning",
      "recommendation": "添加适当的permissions配置以遵循最小权限原则"
    },
    {
      "file": ".github/workflows/test.yml",
      "type": "insecure_env",
      "path": "jobs.backend-unit-tests.services.postgres.env.POSTGRES_PASSWORD",
      "message": "敏感环境变量应使用secrets: POSTGRES_PASSWORD",
      "severity": "warning",
      "recommendation": "使用 ${{ secrets.POSTGRES_PASSWORD }} 替代直接赋值"
    },
    {
      "file": ".github/workflows/test.yml",
      "type": "insecure_env",
      "path": "jobs.integration-tests.services.postgres.env.POSTGRES_PASSWORD",
      "message": "敏感环境变量应使用secrets: POSTGRES_PASSWORD",
      "severity": "warning",
      "recommendation": "使用 ${{ secrets.POSTGRES_PASSWORD }} 替代直接赋值"
    },
    {
      "file": ".github/workflows/test.yml",
      "type": "insecure_env",
      "path": "jobs.e2e-tests.services.postgres.env.POSTGRES_PASSWORD",
      "message": "敏感环境变量应使用secrets: POSTGRES_PASSWORD",
      "severity": "warning",
      "recommendation": "使用 ${{ secrets.POSTGRES_PASSWORD }} 替代直接赋值"
    },
    {
      "file": ".github/workflows/test.yml",
      "type": "insecure_env",
      "path": "jobs.performance-tests.services.postgres.env.POSTGRES_PASSWORD",
      "message": "敏感环境变量应使用secrets: POSTGRES_PASSWORD",
      "severity": "warning",
      "recommendation": "使用 ${{ secrets.POSTGRES_PASSWORD }} 替代直接赋值"
    },
    {
      "file": ".github/workflows/test.yml",
      "type": "potential_hardcoded_secret",
      "path": "jobs.performance-tests.steps[4].run",
      "message": "可能包含硬编码的密钥或令牌",
      "severity": "warning",
      "value": "sudo gpg -k\nsudo gpg --no-default-keyring --keyrin..."
    },
    {
      "file": ".github/workflows/update-badges.yml",
      "type": "excessive_permissions",
      "message": "权限配置过于宽泛",
      "severity": "warning",
      "recommendation": "使用最小权限原则，只授予必要的权限"
    }
  ],
  "recommendations": [
    {
      "type": "security",
      "title": "敏感环境变量安全建议",
      "description": "以下环境变量可能包含敏感信息，建议使用GitHub Secrets",
      "items": [
        "SONAR_TOKEN",
        "JWT_SECRET",
        "STRIPE_SECRET_KEY",
        "SENDGRID_API_KEY",
        "EMAIL_PASSWORD",
        "GITHUB_TOKEN",
        "AUTHOR",
        "POSTGRES_PASSWORD",
        "SONARQUBE_TOKEN",
        "CODECOV_TOKEN",
        "UPTIME_ROBOT_API_KEY"
      ],
      "action": "在GitHub仓库设置中添加这些变量到Secrets，并在工作流中使用${{ secrets.VARIABLE_NAME }}引用"
    },
    {
      "type": "configuration",
      "title": "可能缺失的密钥配置",
      "description": "以下是常见的密钥配置，请检查是否需要",
      "items": [
        "DEPLOY_KEY",
        "API_KEY"
      ],
      "action": "根据项目需要在GitHub Secrets中配置相应的密钥"
    }
  ],
  "generated_at": "2025-08-23T09:19:32.177Z"
}